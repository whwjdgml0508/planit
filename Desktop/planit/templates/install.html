{% extends 'base.html' %}
{% load static %}

{% block title %}홈 화면에 추가 - PlanIt{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="bg-primary text-white py-5 mb-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="display-4 fw-bold mb-3">
                    <i class="bi bi-plus-circle me-3"></i>홈 화면에 추가
                </h1>
                <p class="lead mb-4">
                    언제 어디서나 PlanIt을 사용하세요.<br>
                    홈 화면에 추가하여 앱처럼 사용할 수 있습니다.
                </p>
            </div>
            <div class="col-lg-6 text-center">
                <i class="bi bi-phone display-1 opacity-75"></i>
            </div>
        </div>
    </div>
</div>

<!-- Quick Install Section -->
<div class="container mb-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card border-0 shadow-lg bg-gradient" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <div class="card-body text-center text-white py-5">
                    <h3 class="fw-bold mb-4">
                        <i class="bi bi-rocket-takeoff me-2"></i>지금 바로 홈 화면에 추가하세요!
                    </h3>
                    <p class="mb-4 opacity-90">브라우저에서 바로 앱처럼 사용할 수 있습니다</p>
                    <button id="quickInstallPWA" class="btn btn-light btn-lg px-5 py-3 shadow">
                        <i class="bi bi-plus-circle text-info me-2" style="font-size: 1.5rem;"></i>
                        <strong>홈 화면에 추가</strong>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- PWA Installation Guide -->
<div class="container mb-5">
    <div class="row text-center mb-5">
        <div class="col-12">
            <h2 class="fw-bold mb-3">홈 화면에 추가하는 방법</h2>
            <p class="text-muted">브라우저별 설치 방법을 확인하세요</p>
        </div>
    </div>
    
    <div class="row g-4 justify-content-center">
        <!-- Chrome/Edge -->
        <div class="col-md-4">
            <div class="card h-100 shadow-sm border-0 text-center">
                <div class="card-body p-4">
                    <div class="bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 100px; height: 100px;">
                        <i class="bi bi-browser-chrome text-primary" style="font-size: 3rem;"></i>
                    </div>
                    <h5 class="card-title fw-bold">Chrome / Edge</h5>
                    <p class="card-text text-muted mb-4">
                        1. 브라우저 메뉴(⋮) 클릭<br>
                        2. "홈 화면에 추가" 선택<br>
                        3. "추가" 버튼 클릭
                    </p>
                    <button id="installPWA" class="btn btn-primary btn-lg w-100" style="font-size: 1.2rem; padding: 15px;">
                        <i class="bi bi-plus-circle me-2" style="font-size: 1.5rem;"></i>
                        <strong>홈 화면에 추가</strong>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Safari -->
        <div class="col-md-4">
            <div class="card h-100 shadow-sm border-0 text-center">
                <div class="card-body p-4">
                    <div class="bg-info bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 100px; height: 100px;">
                        <i class="bi bi-browser-safari text-info" style="font-size: 3rem;"></i>
                    </div>
                    <h5 class="card-title fw-bold">Safari (iOS)</h5>
                    <p class="card-text text-muted mb-4">
                        1. 공유 버튼(□↗) 클릭<br>
                        2. "홈 화면에 추가" 선택<br>
                        3. "추가" 버튼 클릭
                    </p>
                    <div class="mb-3">
                        <small class="text-muted">
                            <i class="bi bi-info-circle me-1"></i>
                            iPhone, iPad 지원
                        </small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Samsung Internet -->
        <div class="col-md-4">
            <div class="card h-100 shadow-sm border-0 text-center">
                <div class="card-body p-4">
                    <div class="bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 100px; height: 100px;">
                        <i class="bi bi-phone text-success" style="font-size: 3rem;"></i>
                    </div>
                    <h5 class="card-title fw-bold">Samsung Internet</h5>
                    <p class="card-text text-muted mb-4">
                        1. 메뉴(≡) 클릭<br>
                        2. "페이지를 추가" → "홈 화면" 선택<br>
                        3. "추가" 버튼 클릭
                    </p>
                    <div class="mb-3">
                        <small class="text-muted">
                            <i class="bi bi-info-circle me-1"></i>
                            Android 기본 브라우저
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- FAQ Section -->
<div class="bg-light py-5">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-4">
                <h3 class="fw-bold">자주 묻는 질문</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="accordion" id="faqAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                홈 화면에 추가하면 어떤 장점이 있나요?
                            </button>
                        </h2>
                        <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                홈 화면에 추가하면 앱처럼 사용할 수 있습니다. 브라우저 주소창 없이 전체 화면으로 사용할 수 있고, 홈 화면에서 바로 접근할 수 있어 편리합니다.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                모든 브라우저에서 홈 화면에 추가할 수 있나요?
                            </button>
                        </h2>
                        <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                대부분의 최신 브라우저에서 지원됩니다. Chrome, Edge, Safari, Samsung Internet, Firefox 등에서 "홈 화면에 추가" 기능을 사용할 수 있습니다.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                홈 화면에 추가한 앱은 어떻게 업데이트되나요?
                            </button>
                        </h2>
                        <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                웹앱은 자동으로 최신 버전으로 업데이트됩니다. 별도의 업데이트 과정이 필요하지 않으며, 항상 최신 기능을 사용할 수 있습니다.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}


{% block extra_js %}
<script>
// Direct PWA Install for Android
function installPWADirect() {
    if (deferredPrompt) {
        // PWA 설치 프롬프트가 있으면 바로 실행
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
                alert('✅ PlanIt이 홈 화면에 추가되었습니다!');
            }
            deferredPrompt = null;
        });
    } else {
        // PWA 설치 프롬프트가 없으면 수동 안내
        showManualInstallGuide();
    }
}

// 수동 설치 안내
function showManualInstallGuide() {
    const userAgent = navigator.userAgent.toLowerCase();
    let instructions = '';
    
    if (userAgent.includes('chrome')) {
        instructions = '1. Chrome 메뉴(⋮) 클릭\n2. "홈 화면에 추가" 선택\n3. "추가" 버튼 클릭';
    } else if (userAgent.includes('samsung')) {
        instructions = '1. Samsung Internet 메뉴(≡) 클릭\n2. "페이지를 추가" → "홈 화면" 선택\n3. "추가" 버튼 클릭';
    } else if (userAgent.includes('firefox')) {
        instructions = '1. Firefox 메뉴(⋮) 클릭\n2. "홈 화면에 설치" 선택\n3. "추가" 버튼 클릭';
    } else {
        instructions = '1. 브라우저 메뉴 클릭\n2. "홈 화면에 추가" 또는 "바로가기 추가" 선택\n3. "추가" 버튼 클릭';
    }
    
    alert('📱 PlanIt을 홈 화면에 추가하는 방법:\n\n' + instructions + '\n\n추가 후 홈 화면의 PlanIt 아이콘을 터치하면 앱처럼 사용할 수 있습니다!');
}


// PWA Install functionality
let deferredPrompt;
const installButton = document.getElementById('installPWA');
const quickInstallButton = document.getElementById('quickInstallPWA');

window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installButton.style.display = 'block';
});

const handlePWAInstall = async () => {
    if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        if (outcome === 'accepted') {
            console.log('PWA installed');
        }
        deferredPrompt = null;
    } else {
        // Fallback for browsers that don't support PWA install
        alert('이 브라우저에서는 홈 화면에 추가 기능을 지원하지 않습니다. 브라우저 메뉴에서 "홈 화면에 추가" 옵션을 찾아보세요.');
    }
};

installButton.addEventListener('click', handlePWAInstall);
quickInstallButton.addEventListener('click', handlePWAInstall);

// Hide install button if PWA is already installed
window.addEventListener('appinstalled', () => {
    installButton.style.display = 'none';
    console.log('PWA was installed');
});
</script>
{% endblock %}
