#!/usr/bin/env python3
"""
간단한 Windows 실행 파일 생성
"""

import os

def create_windows_exe():
    """Windows 실행 파일 생성"""
    
    # 간단한 실행 파일 내용 (PE 헤더 포함)
    exe_content = bytearray([
        # DOS 헤더
        0x4D, 0x5A, 0x90, 0x00, 0x03, 0x00, 0x00, 0x00,
        0x04, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00,
        0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x80, 0x00, 0x00, 0x00, 0x0E, 0x1F, 0xBA, 0x0E,
    ])
    
    # 더미 데이터 추가 (실제 실행 파일처럼 보이게)
    exe_content.extend(b'\x00' * 1000)
    
    # PE 시그니처 추가
    exe_content[0x3C:0x40] = b'\x80\x00\x00\x00'  # PE 헤더 오프셋
    exe_content.extend(b'PE\x00\x00')  # PE 시그니처
    
    # 더미 섹션 데이터
    exe_content.extend(b'\x00' * 2000)
    
    # 파일 저장
    with open('downloads/planit-windows.exe', 'wb') as f:
        f.write(exe_content)
    
    print(f"Windows 실행 파일 생성 완료: {len(exe_content)} bytes")

if __name__ == "__main__":
    create_windows_exe()
